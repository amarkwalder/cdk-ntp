version: '1.0'
steps:
  build:
    type: build
    description: Build ${{IMAGE_NAME}}
    dockerfile: Dockerfile
    image-name: ${{IMAGE_NAME}} 
    tag: ${{CF_BRANCHNAME}}
 
  push-dockerhub:
    type: push
    description: Push to hub.docker.com - ${{IMAGE_NAME}}:${{CF_BRANCHNAME}}
    candidate: ${{build}}
    tag: ${{CF_BRANCHNAME}}
    credentials:
      username: ${{username}}
      password: ${{password}}
    fail-fast: false

  push-dockerhub-latest:
    type: push
    description: Push to hub.docker.com - ${{IMAGE_NAME}}:latest
    candidate: ${{build}}
    tag: latest 
    credentials:
      username: ${{username}}
      password: ${{password}}
    fail-fast: false
